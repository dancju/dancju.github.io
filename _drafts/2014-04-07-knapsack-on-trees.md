---
layout: post
title: 樹上的背包
---

偶開腦洞，尚不知道這樹上的背包有沒有被研究過。

## 樹上的 0-1 背包

給定 `N` 件物品，每個物品有一個價值 `v[i]` 與一个重量 `w[i]`。並給定一個 `parent[]` 數組以描
述物品間的依賴關係。每件物品 `v` 或為主件可直接購買（`parent[v] == NULL`）；或為某主件 `u` 之
附件僅當其主件被購買時方可購買（`parent[v] == u`）。`parent[]` 所形成的依賴關係不成環，即一棵
樹。現須於其中選擇部分物品購買，其重量之和不超過上限 `W`，並使所選物品價值之和最大。

### 分析

### 算法

1. 讀數 `N`，`W` 與數組 `v[]`，`w[]`，`parent[]`。
2. 依 `parent[]` 建森林，再使所有樹根為一虛擬結點之子結點。
3. 求樹的先序遍歷 `p[]`，以及以每個結點為根的子樹所包含的結點數 `size[]`。
4. 做動態規劃。第一维 DFS，第二维顺推。转移式 `f[i+size[i]][j+w[i]] = max(f[i+p[size[i]]][j+w[i]], f[i][j]+v[i]);`.

时空复杂度爲 `Θ (NW)`。
