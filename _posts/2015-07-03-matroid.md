---
layout: post
title: Matroid
---

This post is about matroid, greedy algorithm, and graph theory.

## Definition

### Finite matroid

__Definition.__ A _finite matroid_ $\mathcal M$ is a pair $(E, \mathcal I)$ where $E$ is a finite set and $\mathcal I$ is a family of subsets of $E$ satisfying

1. $\emptyset\in\mathcal I\,;$
1. $A\in\mathcal I\implies\forall B\subset A:B\in\mathcal I\,;$
1. $A\in\mathcal I,B\in\mathcal I,\|B\|>\|A\|\implies\exists x\in B\setminus A:A\cup\\{x\\}\in\mathcal I\,.$

$E$ is called _ground set_. The subsets in $\mathcal I$ are called _independent sets_.

### Basis

__Definition.__ A _maximal independent set_ of a matroid, aka a _basis_ of a matroid, is an independent set which becomes dependent on adding any element of $E$. Specifically, $A$ is a basis of matroid $\mathcal M=(E, \mathcal I)$ iff

$$A\in\mathcal I, \forall x\in E\setminus A:A\cup\{x\}\notin\mathcal I\,.$$

### Weighted matroid

__Definition.__ A _weighted matroid_ is a matroid $\mathcal M=(E, \mathcal I)$ together with a function $w$ from its elements to the non-negative real numbers:

$$w:x\to[0,+\infty)\mid x\in E\,.$$

__Definition.__ The weight of a set is the sum of the weights of the elements in the set:

$$w(A)=\sum_{x\in A}w(x)\,.$$

## Greedy algorithm

The greedy algorithm can be used to find a maximum-weight basis of any given matroid, by starting from the empty set and repeatedly adding one element at a time, at each step choosing a maximum-weight element among the elements whose addition would preserve the independence of the augmented set.

> __Data:__ a matroid $\mathcal M=(E, \mathcal I)$, and a function $w:E\to[0,+\infty)\,.$
> __Result:__ a maximum-weight basis of $\mathcal M$
> sort $E$ by decreasing order
> $A\leftarrow\emptyset$
> __for all__ $x\in E$ __do__
>
> > __if__ $$A\cup\{x\}\in\mathcal I$$ __then__
> >
> > > $$A\leftarrow A\cup\{x\}$$;
> >
> > __end if__
>
> __end for__
> __return__ $A$

### Proof

__Lemma 1.__ $x$ is the element of the maximum weight satisfying $\{x\}\in \mathcal I$, then $x\in A$ where $A$ is the maximal independent set of maximum weight.

__Lemma 2.__ $A$ is the maximal independent set of the maximum weight. $A'$ is a proper subset of $A$. $x$ is the element of the maximum weight that satisfies:

1. $\\{x\\}\in\mathcal I$,
1. $x\notin A'$.

then $x\in A$, viz. $A'\cup\\{x\\}\subseteq A$.

The validities of Lemma 1 and Lemma 2 are obvious. Therefore we know the algorithm returns a maximum-weight basis for a input matroid.

## Minimum spanning tree

Let $G=(V,E)$ be a weighted undirected graph, where all vertices are connected.

Define $\mathcal M=(E, \mathcal I)$, where $$\mathcal I=\{A\mid A\subseteq E, A\text{ forms a forest}\}$$.

__Lemma 3.__ $\mathcal M=(E, \mathcal I)$ is a matroid.

__Proof.__

1. $\emptyset\in E$, since $\emptyset$ forms a forest that each vertex is a tree;
1. If $A$ forms a forest, then $\forall B\subset A$ forms a forest;
1. $A$ forms a forest of $\|V\|-\|A\|$ trees; $B$ forms a forest of $\|V\|-\|B\|$ trees. Hence, there exists an edge in $B$ that union two trees in $A$ into one.

__Lemma 4.__ For every basis $A$ of matroid $\mathcal M$, $(V,A)$ is a spanning trees of graph $G$.

This one is obvious!

By Lemma 3 and Lemma 4 we know that finding a maximum-weight basis of a matroid is equivalent to finding a minimum spanning tree of a undirected graph. The greedy algorithm in the last section is equivalent to Kruskal's algorithm.

## Another graph theory problem

__Problem.__ For a given weighted undirected graph $G$, find $k$ edges whose removal keeps the graph a single connected component, and maximize/minimize the weight of the resulting graph.

Of course we will define a matroid and reduce the original problem into a find-maximum-weight-basis problem.

For a given graph $(V, E)$, define $\mathcal M=(E, \mathcal I)$, where $$\mathcal I$$ is a family of subsets of $E$ satisfying

1. For subset $E'$, graph $(V, E\setminus E')$ is a single connected component;
1. For subset $E'$, $\|E'\|\le k$.

__Lemma 5.__ $\mathcal M=(E, \mathcal I)$ is a matroid.

__Proof.__ The first two criteria are obviously met for this definition. Our focus is the third one.

Let $A$ and $B$ be two subsets in $\mathcal I$ satisfying $\|A\|<\|B\|$. We need to prove that there exists an edge $x\in B\setminus A$ that makes graph $(V,E\setminus(A\cup\\{x\\}))$ a single connected component, viz. there exists an edge $x\in B\setminus A$ that is not a bridge of graph $(V,E\setminus A)$.

TO BE CONTINUED...
