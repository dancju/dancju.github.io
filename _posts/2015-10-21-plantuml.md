---
layout: post
title: "用 PlantUML 寫軟體文檔"
---

程序員最煩兩件事：給自己的程序寫文檔，和別人的程序沒文檔。用 [PlantUML](http://plantuml.com){:target="_blank"} 和 LaTeX 寫文檔可以讓事情變得簡單。

PlantUML 是一個將 [DOT 代碼](http://www.graphviz.org/doc/info/lang.html){:target="_blank"}編譯成 UML 圖片的軟體。本文給出了一個用 PlantUML 和 LaTeX 寫軟體文檔的例子。

下面是一個示例文檔工程的目錄結構。

<pre>
├ src
│ ├ bar.pu
│ ├ foo.pu
│ └ main.tex
├ uml
│ ├ <i>bar.png</i>
│ └ <i>foo.png</i>
├ <i>main.pdf</i>
└ Makefile
</pre>

其中 `src/main.tex` 是文檔的主源碼；`bar.pu` 和 `foo.pu` 是文檔中兩個 UML 圖的源碼。`uml` 目錄中的文件是由 PlantUML 生成的 UML 圖，除了 PNG，还可以用 PDF 和 EPS 這兩個矢量圖格式。下面是 Makefile 的内容。

```makefile
# Makefile

pu=$(notdir $(wildcard src/*.pu))
png=$(patsubst %.pu,%.png,$(pu))

main.pdf: src/main.tex
	xelatex src/main.tex

uml/%.png: src/%.pu
	plantuml -o uml $^

all: $(addprefix uml/, $(png)) main.pdf

clean:
	rm -f *.toc *.aux *.log *.out

view:
	open main.pdf

.PHONY: all clean view
```
